<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Nezya</title>

<style>
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  -webkit-tap-highlight-color: transparent;
}

body {
  width: 100vw;
  height: 100vh;
  background: center / cover no-repeat;
  font-family: Arial, sans-serif;
  overflow: hidden;
  user-select: none;
}

.overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.45);
}

/* –í–ï–†–• */
.top-ui {
  position: absolute;
  top: 14px;
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  flex-direction: column;
  gap: 6px;
  z-index: 3;
  width: 90%;
  max-width: 420px;
}

.top-bar {
  display: flex;
  gap: 12px;
  justify-content: center;
}

.balance {
  background: rgba(0,0,0,0.65);
  padding: 8px 14px;
  border-radius: 20px;
  font-weight: 900;
  color: #fff;
  display: flex;
  gap: 8px;
  align-items: center;
}

.coin {
  width: 18px;
  height: 18px;
  border-radius: 50%;
  background: radial-gradient(circle at 30% 30%, #fff9c4, #fbc02d);
}

.crystal {
  width: 16px;
  height: 16px;
  clip-path: polygon(50% 0%, 90% 25%, 70% 100%, 30% 100%, 10% 25%);
  background: linear-gradient(135deg, #7dd3fc, #38bdf8);
}

/* –£–†–û–í–ï–ù–¨ */
.level-box {
  background: rgba(0,0,0,0.55);
  border-radius: 14px;
  padding: 6px 10px;
  display: flex;
  align-items: center;
  gap: 8px;
}

.lvl {
  font-weight: 900;
  font-size: 14px;
}

.xp-bar {
  flex: 1;
  height: 8px;
  background: rgba(255,255,255,0.2);
  border-radius: 10px;
  overflow: hidden;
}

.xp-fill {
  height: 100%;
  width: 0%;
  background: linear-gradient(90deg, #fde047, #f59e0b);
  transition: width 0.3s ease;
}

/* –ò–ì–†–ê */
.game {
  position: relative;
  width: 100%;
  height: 100%;
  z-index: 2;
  display: flex;
  align-items: center;
  justify-content: center;
}

.character {
  width: 320px;
  max-width: 85vw;
  transition: transform .12s ease;
  cursor: pointer;
}

/* –ß–ò–°–õ–ê */
.float {
  position: absolute;
  font-size: 34px;
  font-weight: 900;
  color: gold;
  pointer-events: none;
  animation: fly 2s ease-out forwards;
}

@keyframes fly {
  to {
    opacity: 0;
    transform: translate(var(--x), var(--y)) scale(1.4);
  }
}

/* –ù–ò–ó */
.bottom-menu {
  position: absolute;
  bottom: 16px;
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  gap: 14px;
  z-index: 3;
}

.menu-btn {
  padding: 12px 16px;
  border-radius: 18px;
  background: rgba(0,0,0,0.65);
  color: white;
  font-weight: 900;
  text-decoration: none;
}
</style>
</head>

<body>

<div class="overlay"></div>

<div class="top-ui">
  <div class="top-bar">
    <div class="balance"><div class="coin"></div><span id="coins">0</span></div>
    <div class="balance"><div class="crystal"></div><span id="crystals">0</span></div>
  </div>

  <div class="level-box">
    <div class="lvl">LVL <span id="level">1</span></div>
    <div class="xp-bar">
      <div class="xp-fill" id="xpFill"></div>
    </div>
  </div>
</div>

<div class="game">
  <img src="assets/character.png" class="character" id="character">
</div>

<div class="bottom-menu">
  <a href="shop.html" class="menu-btn">üõí –ú–∞–≥–∞–∑–∏–Ω</a>
</div>

<script>
/* ===== –î–ê–ù–ù–´–ï ===== */
let coins = +localStorage.getItem("coins") || 0;
let crystals = +localStorage.getItem("crystals") || 0;
let clicks = +localStorage.getItem("clicks") || 0;

let level = +localStorage.getItem("level") || 1;
let xp = +localStorage.getItem("xp") || 0;

let incomes = JSON.parse(localStorage.getItem("incomes")) || {};
let upgrades = JSON.parse(localStorage.getItem("upgrades")) || {};

let lastOnline = +localStorage.getItem("lastOnline") || Date.now();

/* ===== UI ===== */
const coinsEl = document.getElementById("coins");
const crystalsEl = document.getElementById("crystals");
const levelEl = document.getElementById("level");
const xpFill = document.getElementById("xpFill");
const character = document.getElementById("character");

function xpNeed() {
  return level * 100;
}

function updateUI() {
  coinsEl.textContent = coins;
  crystalsEl.textContent = crystals;
  levelEl.textContent = level;
  xpFill.style.width = Math.min(100, xp / xpNeed() * 100) + "%";
}

/* ===== –ö–õ–ò–ö ===== */
character.onclick = () => {
  clicks++;

  let power = 1 + (upgrades.clickPower || 0);
  coins += power;
  xp += 1;

  checkLevel();
  spawn("+" + power);

  save();
  updateUI();
};

/* ===== –ê–í–¢–û–î–û–•–û–î ===== */
const incomeList = {
  lemonade: 3, shop: 30, factory: 300, bank: 3000,
  corporation: 9000, residential: 15000, business: 30000
};

function incomePerSecond() {
  let sum = 0;
  for (let k in incomes) sum += (incomeList[k] || 0) * incomes[k];
  return sum;
}

setInterval(() => {
  let inc = incomePerSecond();
  coins += inc;
  xp += inc * 0.05;
  checkLevel();
  updateUI();
  save();
}, 1000);

/* ===== –£–†–û–í–ï–ù–¨ ===== */
function checkLevel() {
  while (xp >= xpNeed()) {
    xp -= xpNeed();
    level++;
    spawn("LVL UP!");
  }
}

/* ===== –≠–§–§–ï–ö–¢ ===== */
function spawn(text) {
  const r = character.getBoundingClientRect();
  const el = document.createElement("div");
  el.className = "float";
  el.textContent = text;
  el.style.left = r.left + r.width / 2 + "px";
  el.style.top = r.top + r.height / 2 + "px";
  el.style.setProperty("--x", (Math.random()*200-100)+"px");
  el.style.setProperty("--y", (-Math.random()*150-50)+"px");
  document.body.appendChild(el);
  setTimeout(()=>el.remove(),2000);
}

/* ===== –°–û–•–†–ê–ù–ï–ù–ò–ï ===== */
function save() {
  localStorage.setItem("coins", coins);
  localStorage.setItem("crystals", crystals);
  localStorage.setItem("clicks", clicks);
  localStorage.setItem("level", level);
  localStorage.setItem("xp", xp);
  localStorage.setItem("lastOnline", Date.now());
}

updateUI();
save();
</script>

</body>
</html>
