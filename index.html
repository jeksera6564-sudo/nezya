<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Nezya</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}
body{
  width:100vw;height:100vh;
  background:center/cover no-repeat;
  font-family:Arial,sans-serif;
  overflow:hidden;
  user-select:none;
}
.overlay{position:fixed;inset:0;background:rgba(0,0,0,.45)}

.top-bar{
  padding-top:12px;
  display:flex;
  flex-direction:column;
  gap:6px;
  align-items:center;
  z-index:5;
}

.balances{display:flex;gap:12px}
.balance{
  background:rgba(0,0,0,.65);
  padding:10px 16px;
  border-radius:20px;
  font-weight:900;
  color:#fff;
  display:flex;
  gap:8px;
  align-items:center;
}

.income{font-size:13px;opacity:.85}

.coin{
  width:20px;height:20px;border-radius:50%;
  background:radial-gradient(circle at 30% 30%,#fff9c4,#fbc02d)
}
.crystal{
  width:18px;height:18px;
  clip-path:polygon(50% 0%,90% 25%,70% 100%,30% 100%,10% 25%);
  background:linear-gradient(135deg,#7dd3fc,#38bdf8)
}

.sound-toggle,.vibe-toggle{
  position:fixed;
  right:12px;
  background:rgba(0,0,0,.65);
  color:white;
  padding:8px 12px;
  border-radius:14px;
  font-weight:900;
  cursor:pointer;
  z-index:10;
}
.sound-toggle{top:12px}
.vibe-toggle{top:54px}

.game{
  flex:1;
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:14px;
  padding-top:10px;
}

.character{
  width:300px;
  max-width:80vw;
  cursor:pointer;
  transition:.12s;
}

.bottom-menu{
  display:flex;
  gap:14px;
}
.menu-btn{
  padding:12px 18px;
  border-radius:18px;
  background:rgba(0,0,0,.65);
  color:white;
  font-weight:900;
  text-decoration:none;
}
</style>
</head>

<body>

<div class="overlay"></div>

<div class="sound-toggle" id="soundBtn"></div>
<div class="vibe-toggle" id="vibeBtn"></div>

<div class="top-bar">
  <div class="balances">
    <div class="balance"><div class="coin"></div><span id="coins">0</span></div>
    <div class="balance"><div class="crystal"></div><span id="crystals">0</span></div>
  </div>
  <div class="income" id="incomeInfo">+0/—Å–µ–∫ ‚Ä¢ +0/–º–∏–Ω</div>
</div>

<div class="game">
  <img id="character" class="character">

  <div class="bottom-menu">
    <a href="shop.html" class="menu-btn">üõí –ú–∞–≥–∞–∑–∏–Ω</a>
    <a href="characters.html" class="menu-btn">üßç –ü–µ—Ä—Å–æ–Ω–∞–∂–∏</a>
  </div>
</div>

<script>
document.body.style.backgroundImage="url('assets/bg.jpg')";

/* –≠–õ–ï–ú–ï–ù–¢–´ */
const coinsEl = document.getElementById("coins");
const crystalsEl = document.getElementById("crystals");
const incomeInfo = document.getElementById("incomeInfo");
const character = document.getElementById("character");
const soundBtn = document.getElementById("soundBtn");
const vibeBtn = document.getElementById("vibeBtn");

/* –ù–ê–°–¢–†–û–ô–ö–ò */
let soundEnabled = localStorage.getItem("sound") !== "off";
let vibeEnabled  = localStorage.getItem("vibe")  !== "off";
soundBtn.textContent = soundEnabled ? "üîä ON" : "üîá OFF";
vibeBtn.textContent  = vibeEnabled  ? "üì≥ ON" : "üì¥ OFF";

/* –î–ê–ù–ù–´–ï */
let coins = +localStorage.getItem("coins") || 0;
let crystals = +localStorage.getItem("crystals") || 0;
let lastTick = +localStorage.getItem("lastTick") || Date.now();

/* –ü–ï–†–°–û–ù–ê–ñ */
const characters={
  default:{img:"assets/player.png",power:1,crystal:0},
  clicker:{img:"assets/character_clicker.png",power:2,crystal:0},
  business:{img:"assets/character_business.png",power:4,crystal:1},
  magnate:{img:"assets/character_magnate.png",power:7,crystal:2},
  legendary:{img:"assets/character_legendary.png",power:15,crystal:5}
};
let active = localStorage.getItem("activeCharacter") || "default";
character.src = characters[active].img;

/* –ö–ù–û–ü–ö–ò */
soundBtn.onclick=()=>{
  soundEnabled=!soundEnabled;
  localStorage.setItem("sound",soundEnabled?"on":"off");
  soundBtn.textContent=soundEnabled?"üîä ON":"üîá OFF";
};
vibeBtn.onclick=()=>{
  vibeEnabled=!vibeEnabled;
  localStorage.setItem("vibe",vibeEnabled?"on":"off");
  vibeBtn.textContent=vibeEnabled?"üì≥ ON":"üì¥ OFF";
};

/* –ü–ê–°–°–ò–í–ù–´–ô –î–û–•–û–î */
function getPassive(){
  const base={lemonade:3,shop:30,factory:300,bank:3000,corp:9000};
  const data=JSON.parse(localStorage.getItem("incomes"))||{};
  let c=0,d=0;
  for(let k in base){
    c+=(data[k]||0)*base[k];
    d+=Math.floor((data[k]||0)/5);
  }
  return {c,d};
}

function passiveTick(){
  const now=Date.now();
  const diff=Math.floor((now-lastTick)/1000);
  if(diff<=0) return;
  const p=getPassive();
  coins+=p.c*diff;
  crystals+=p.d*diff;
  lastTick=now;
  save();
  updateUI();
}
setInterval(passiveTick,1000);
passiveTick();

/* –ö–õ–ò–ö */
character.onclick=()=>{
  const ch=characters[active];
  coins+=ch.power;
  crystals+=ch.crystal;
  if(vibeEnabled && navigator.vibrate) navigator.vibrate(30);
  save();
  updateUI();
};

function save(){
  localStorage.setItem("coins",coins);
  localStorage.setItem("crystals",crystals);
  localStorage.setItem("lastTick",lastTick);
}

function updateUI(){
  coinsEl.textContent = coins;
  crystalsEl.textContent = crystals;
  const p=getPassive();
  incomeInfo.textContent=`+${p.c}/—Å–µ–∫ ‚Ä¢ +${p.c*60}/–º–∏–Ω`;
}

updateUI();
</script>

</body>
</html>
