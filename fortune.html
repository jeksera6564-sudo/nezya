<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Mega Wheels ‚Äî Nezya Edition</title>
    <style>
        :root {
            --gold: #ffd700;
            --neon-blue: #00d2ff;
            --neon-purple: #9d00ff;
            --neon-red: #ff4d4d;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body { 
            width: 100vw; height: 100vh; 
            background: #020205;
            font-family: 'Segoe UI', sans-serif; overflow: hidden; color: white;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            transition: background 0.8s ease;
        }

        /* –°–∏—è–Ω–∏–µ —Ñ–æ–Ω–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–æ–ª–µ—Å–∞ */
        .bg-glow {
            position: absolute; width: 100%; height: 100%;
            z-index: 1; opacity: 0.3; transition: 0.8s;
        }

        .balance-top { position: absolute; top: 20px; display: flex; gap: 10px; z-index: 20; }
        .bal { 
            background: rgba(0,0,0,0.7); padding: 8px 15px; border-radius: 15px; 
            border: 2px solid var(--gold); font-weight: 900; min-width: 100px; 
            text-align: center; backdrop-filter: blur(10px); font-size: 14px;
        }

        /* –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –∏–∑ 3 –∫–Ω–æ–ø–æ–∫ */
        .mode-switch {
            margin-bottom: 25px; background: rgba(255,255,255,0.05);
            padding: 5px; border-radius: 40px; border: 1px solid rgba(255,255,255,0.1);
            display: flex; gap: 5px; z-index: 30;
        }
        .mode-btn {
            padding: 10px 15px; border-radius: 30px; border: none;
            cursor: pointer; font-weight: 900; font-size: 10px;
            transition: 0.3s; background: transparent; color: #555; text-transform: uppercase;
        }
        .mode-btn.active.coin { background: var(--gold); color: #000; box-shadow: 0 0 15px var(--gold); }
        .mode-btn.active.vip { background: var(--neon-purple); color: #fff; box-shadow: 0 0 15px var(--neon-purple); }
        .mode-btn.active.ultra { background: var(--neon-red); color: #fff; box-shadow: 0 0 20px var(--neon-red); }

        .wheel-container { 
            position: relative; width: 330px; height: 330px; margin-bottom: 20px; z-index: 10;
        }

        .wheel {
            width: 100%; height: 100%; border-radius: 50%; border: 8px solid var(--gold);
            transition: transform 5s cubic-bezier(0.15, 0, 0.15, 1), border-color 0.5s;
            position: relative; overflow: hidden; box-shadow: 0 0 50px rgba(0, 0, 0, 0.8);
        }

        .segment {
            position: absolute; width: 50%; height: 50%; left: 50%; top: 50%; transform-origin: 0% 0%;
            display: flex; align-items: center; justify-content: flex-start;
            padding-left: 45px; font-weight: 900; font-size: 12px;
            text-shadow: 0 0 8px rgba(0,0,0,1); pointer-events: none;
        }

        .pointer {
            position: absolute; top: -10px; left: 50%; transform: translateX(-50%);
            width: 0; height: 0; border-left: 18px solid transparent; border-right: 18px solid transparent;
            border-top: 40px solid var(--gold); z-index: 50; filter: drop-shadow(0 0 10px var(--gold));
            transition: 0.5s;
        }

        .center-cap {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 55px; height: 55px; background: var(--gold); border: 3px solid #fff;
            border-radius: 50%; z-index: 60; box-shadow: 0 0 25px var(--gold);
            display: flex; align-items: center; justify-content: center; font-size: 22px;
            transition: 0.5s;
        }

        .spin-btn {
            background: linear-gradient(45deg, var(--gold), #ff7f50);
            color: #000; border: none; padding: 18px 60px; z-index: 10;
            border-radius: 50px; font-weight: 900; font-size: 22px; cursor: pointer;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.4); transition: 0.3s;
        }
        .spin-btn:active { transform: scale(0.95); }
        .spin-btn:disabled { opacity: 0.4; pointer-events: none; }

        .jackpot-alert {
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.95); border: 3px solid var(--neon-red);
            padding: 40px; border-radius: 30px; text-align: center; z-index: 100; display: none;
        }
    </style>
</head>
<body id="mainBody">

    <div class="bg-glow" id="bgGlow"></div>

    <div class="jackpot-alert" id="jackpotBox">
        <h1 style="color: var(--gold); margin-bottom: 10px;">üî• MEGA JACKPOT!</h1>
        <p style="font-size: 20px;">–í—ã –ø–æ–ª—É—á–∏–ª–∏ —Å–µ–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞:<br><b style="color: #ff4d4d; font-size: 30px;">–ú–ê–ì–ù–ê–¢</b></p>
        <button class="spin-btn" style="margin-top: 20px;" onclick="closeJackpot()">–ó–ê–ë–†–ê–¢–¨</button>
    </div>

    <div class="balance-top">
        <div class="bal" style="border-color: var(--gold);">ü™ô <span id="coins">0</span></div>
        <div class="bal" style="border-color: var(--neon-blue);">üíé <span id="crystals">0</span></div>
    </div>

    <div class="mode-switch">
        <button id="btn-coin" class="mode-btn active coin" onclick="setMode('coin')">–û–±—ã—á–Ω–æ–µ</button>
        <button id="btn-vip" class="mode-btn vip" onclick="setMode('vip')">VIP</button>
        <button id="btn-ultra" class="mode-btn ultra" onclick="setMode('ultra')">Ultra 5k</button>
    </div>

    <div class="wheel-container">
        <div class="pointer" id="pointer"></div>
        <div class="center-cap" id="cap">ü™ô</div>
        <div class="wheel" id="wheel"></div>
    </div>

    <div class="controls" style="text-align: center;">
        <button id="spinBtn" class="spin-btn" onclick="spin()">–ö–†–£–¢–ò–¢–¨</button>
        <div id="timer" style="margin-top: 15px; color: #fff; font-weight: bold; font-size: 14px;">–£–¥–∞—á–∏!</div>
        <a href="index.html" style="margin-top: 20px; color: #555; display: block; text-decoration: none; font-size: 12px;">–ù–ê–ó–ê–î –í –ò–ì–†–£</a>
    </div>

<script>
    let currentMode = 'coin';
    let isSpinning = false;
    let state = {
        coins: +localStorage.getItem("coins") || 0,
        crystals: +localStorage.getItem("crystals") || 0,
        lastSpin: +localStorage.getItem("lastSpinTime") || 0,
        ownedHeroes: JSON.parse(localStorage.getItem("characters")) || { default: true }
    };

    const wheelData = {
        coin: {
            cost: 50000, curr: 'coin', color: '#ffa502', glow: 'radial-gradient(circle, rgba(255,165,0,0.2) 0%, transparent 70%)', cap: 'ü™ô',
            prizes: [{n:"100k ü™ô",v:100000,t:'c'}, {n:"5 üíé",v:5,t:'d'}, {n:"50k ü™ô",v:50000,t:'c'}, {n:"1 üíé",v:1,t:'d'}, {n:"200k ü™ô",v:200000,t:'c'}, {n:"10k ü™ô",v:10000,t:'c'}, {n:"10 üíé",v:10,t:'d'}, {n:"5k ü™ô",v:5000,t:'c'}]
        },
        vip: {
            cost: 100, curr: 'cry', color: '#9d00ff', glow: 'radial-gradient(circle, rgba(157,0,255,0.2) 0%, transparent 70%)', cap: 'üíé',
            prizes: [{n:"500 üíé",v:500,t:'d'}, {n:"10k ü™ô",v:10000,t:'c'}, {n:"10 üíé",v:10,t:'d'}, {n:"5k ü™ô",v:5000,t:'c'}, {n:"200 üíé",v:200,t:'d'}, {n:"1k ü™ô",v:1000,t:'c'}, {n:"50 üíé",v:50,t:'d'}, {n:"500 ü™ô",v:500,t:'c'}]
        },
        ultra: {
            cost: 5000, curr: 'cry', color: '#ff4d4d', glow: 'radial-gradient(circle, rgba(255,77,77,0.2) 0%, transparent 70%)', cap: 'üî•',
            prizes: [{n:"10k üíé",v:10000,t:'d'}, {n:"1M ü™ô",v:1000000,t:'c'}, {n:"5k üíé",v:5000,t:'d'}, {n:"2M ü™ô",v:2000000,t:'c'}, {n:"7k üíé",v:7000,t:'d'}, {n:"500k ü™ô",v:500000,t:'c'}, {n:"3k üíé",v:3000,t:'d'}, {n:"100 üíé",v:100,t:'d'}]
        }
    };

    function setMode(mode) {
        if (isSpinning) return;
        currentMode = mode;
        const data = wheelData[mode];
        
        // UI –∫–Ω–æ–ø–∫–∏
        document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(`btn-${mode}`).classList.add('active');
        
        // –¶–≤–µ—Ç–∞ —Ç–µ–º—ã
        document.getElementById("bgGlow").style.background = data.glow;
        document.getElementById("wheel").style.borderColor = data.color;
        document.getElementById("pointer").style.borderTopColor = data.color;
        document.getElementById("cap").style.background = data.color;
        document.getElementById("cap").textContent = data.cap;
        
        const wheel = document.getElementById("wheel");
        wheel.innerHTML = "";
        wheel.style.background = `conic-gradient(${data.color} 0deg 45deg, #121212 45deg 90deg, ${data.color} 90deg 135deg, #121212 135deg 180deg, ${data.color} 180deg 225deg, #121212 225deg 270deg, ${data.color} 270deg 315deg, #121212 315deg 360deg)`;

        data.prizes.forEach((p, i) => {
            const div = document.createElement("div");
            div.className = "segment";
            div.style.transform = `rotate(${i * 45 + 22.5}deg) rotate(-90deg)`;
            div.innerHTML = p.n;
            wheel.appendChild(div);
        });
        updateUI();
    }

    function updateUI() {
        document.getElementById("coins").textContent = Math.floor(state.coins).toLocaleString();
        document.getElementById("crystals").textContent = state.crystals.toLocaleString();
        const data = wheelData[currentMode];
        const btn = document.getElementById("spinBtn");
        
        if (currentMode === 'vip') {
            const diff = Date.now() - state.lastSpin;
            if (diff < 86400000) {
                btn.textContent = `–ó–ê ${data.cost} üíé`;
                document.getElementById("timer").textContent = `–ë–µ—Å–ø–ª–∞—Ç–Ω–æ —á–µ—Ä–µ–∑: ${Math.floor((86400000-diff)/3600000)}—á`;
            } else {
                btn.textContent = "–ë–ï–°–ü–õ–ê–¢–ù–û";
                document.getElementById("timer").textContent = "VIP –±–æ–Ω—É—Å –≥–æ—Ç–æ–≤!";
            }
        } else {
            btn.textContent = `–ó–ê ${data.cost.toLocaleString()} ${data.curr === 'coin' ? 'ü™ô' : 'üíé'}`;
            document.getElementById("timer").textContent = currentMode === 'ultra' ? "–†–ò–°–ö–ù–ò –í–°–ï–ú!" : "–ü–æ–ø—Ä–æ–±—É–π —É–¥–∞—á—É!";
        }
    }

    function spin() {
        if (isSpinning) return;
        const data = wheelData[currentMode];
        
        if (currentMode === 'coin' && state.coins < data.cost) return alert("–ú–∞–ª–æ –º–æ–Ω–µ—Ç!");
        if (currentMode === 'ultra' && state.crystals < data.cost) return alert("–ú–∞–ª–æ –∫—Ä–∏—Å—Ç–∞–ª–ª–æ–≤!");
        if (currentMode === 'vip') {
            const isFree = (Date.now() - state.lastSpin) >= 86400000;
            if (!isFree && state.crystals < data.cost) return alert("–ú–∞–ª–æ –∫—Ä–∏—Å—Ç–∞–ª–ª–æ–≤!");
            if (isFree) { state.lastSpin = Date.now(); localStorage.setItem("lastSpinTime", state.lastSpin); }
            else state.crystals -= data.cost;
        } else {
            if (data.curr === 'coin') state.coins -= data.cost;
            else state.crystals -= data.cost;
        }

        isSpinning = true;
        document.getElementById("spinBtn").disabled = true;

        const targetSector = Math.floor(Math.random() * 8);
        // –®–∞–Ω—Å –Ω–∞ –º–∞–≥–Ω–∞—Ç–∞ 0.04%. –í –£–ª—å—Ç—Ä–∞ –∫–æ–ª–µ—Å–µ —à–∞–Ω—Å –≤—ã—à–µ –≤ 5 —Ä–∞–∑ (0.2%)
        const chance = currentMode === 'ultra' ? 0.002 : 0.0004;
        const gotMagnat = Math.random() < chance;

        const totalRot = 3600 + (360 - (targetSector * 45));
        const wheel = document.getElementById("wheel");
        wheel.style.transform = `rotate(${totalRot}deg)`;

        setTimeout(() => {
            isSpinning = false;
            document.getElementById("spinBtn").disabled = false;
            
            if (gotMagnat && !state.ownedHeroes["magnate"]) {
                state.ownedHeroes["magnate"] = true;
                localStorage.setItem("characters", JSON.stringify(state.ownedHeroes));
                document.getElementById("jackpotBox").style.display = "block";
            }

            const prize = data.prizes[targetSector];
            if (prize.t === 'c') state.coins += prize.v; else state.crystals += prize.v;

            localStorage.setItem("coins", state.coins);
            localStorage.setItem("crystals", state.crystals);
            updateUI();
            
            wheel.style.transition = "none";
            wheel.style.transform = `rotate(${totalRot % 360}deg)`;
            setTimeout(() => wheel.style.transition = "transform 5s cubic-bezier(0.15, 0, 0.15, 1)", 50);
        }, 5100);
    }

    function closeJackpot() { document.getElementById("jackpotBox").style.display = "none"; }
    setMode('coin');
</script>
</body>
</html>
