<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–ú–∞–≥–∞–∑–∏–Ω ‚Äî Nezi</title>
    <style>
        body {
            margin: 0; font-family: sans-serif; color: white; min-height: 100vh;
            background: linear-gradient(rgba(0,0,0,0.8), rgba(0,0,0,0.9)), #1a1a1a;
        }
        .top {
            position: sticky; top: 0; z-index: 100; display: flex; justify-content: center; gap: 10px;
            padding: 15px; background: rgba(0,0,0,0.9); backdrop-filter: blur(10px);
        }
        .balance { background: rgba(255,255,255,0.1); padding: 8px 15px; border-radius: 20px; font-weight: bold; }
        .back-wrap { text-align: center; margin: 20px 0; }
        .back { background: #fbbf24; padding: 12px 30px; border-radius: 25px; color: black; font-weight: 900; text-decoration: none; }
        h2 { text-align: center; color: #fbbf24; margin: 20px 0; }
        .shop { display: grid; grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); gap: 15px; padding: 15px; max-width: 900px; margin: 0 auto; }
        .item { background: rgba(255,255,255,0.05); border-radius: 20px; padding: 15px; text-align: center; border: 1px solid rgba(255,255,255,0.1); }
        .item b { color: #fbbf24; display: block; margin: 10px 0; }
        .item button { width: 100%; padding: 10px; border-radius: 12px; border: none; background: #fbbf24; font-weight: bold; cursor: pointer; }
        .item button:disabled { background: #444; color: #888; }
    </style>
</head>
<body>
<div class="top">
    <div class="balance">ü™ô <span id="coins">0</span></div>
    <div class="balance">üíé <span id="crystals">0</span></div>
</div>
<div class="back-wrap"><a href="index.html" class="back">‚¨Ö –ù–ê–ó–ê–î</a></div>
<h2>üè¶ –ë–ò–ó–ù–ï–°</h2>
<div class="shop" id="incomeShop"></div>
<h2>‚ú® –ê–ü–ì–†–ï–ô–î–´</h2>
<div class="shop" id="upgradeShop"></div>

<script>
let state = {
    coins: +localStorage.getItem("coins") || 0,
    crystals: +localStorage.getItem("crystals") || 0,
    incomes: JSON.parse(localStorage.getItem("incomes")) || {},
    upgrades: JSON.parse(localStorage.getItem("upgrades")) || {}
};

const incomeList = {
    lemonade: { name: "üçã –õ–∏–º–æ–Ω–∞–¥", base: 300, inc: 3 },
    shop: { name: "üè™ –ú–∞–≥–∞–∑–∏–Ω", base: 3000, inc: 30 },
    factory: { name: "üè≠ –§–∞–±—Ä–∏–∫–∞", base: 30000, inc: 300 },
    bank: { name: "üè¶ –ë–∞–Ω–∫", base: 300000, inc: 3000 },
    corporation: { name: "üè¢ –ö–æ—Ä–ø", base: 900000, inc: 9000 },
    legendary: { name: "üëë –õ–µ–≥–µ–Ω–¥–∞", base: 3000000, inc: 50000 }
};

const crystalList = {
    crystalClick: { name: "üíé –®–∞–Ω—Å –∫—Ä–∏—Å—Ç–∞–ª–ª–∞", price: 30 },
    crystalIncome: { name: "üí† –ê–≤—Ç–æ-–∫—Ä–∏—Å—Ç–∞–ª–ª", price: 40 },
    ultraBoost: { name: "üöÄ –î–æ—Ö–æ–¥ x2", price: 50 }
};

const getPrice = (base, lvl) => Math.floor(base * Math.pow(1.5, lvl || 0));

function render() {
    document.getElementById("coins").textContent = Math.floor(state.coins).toLocaleString();
    document.getElementById("crystals").textContent = state.crystals;

    const iShop = document.getElementById("incomeShop");
    iShop.innerHTML = "";
    for (let k in incomeList) {
        let cost = getPrice(incomeList[k].base, state.incomes[k]);
        iShop.innerHTML += `<div class="item">
            <h3>${incomeList[k].name}</h3>
            <p>–£—Ä–æ–≤–µ–Ω—å: ${state.incomes[k] || 0}</p>
            <b>${cost.toLocaleString()} ü™ô</b>
            <button ${state.coins < cost ? 'disabled' : ''} onclick="buyI('${k}')">–ö—É–ø–∏—Ç—å</button>
        </div>`;
    }

    const uShop = document.getElementById("upgradeShop");
    uShop.innerHTML = "";
    for (let k in crystalList) {
        let bought = state.upgrades[k];
        uShop.innerHTML += `<div class="item">
            <h3>${crystalList[k].name}</h3>
            <b>${crystalList[k].price} üíé</b>
            <button ${bought || state.crystals < crystalList[k].price ? 'disabled' : ''} onclick="buyU('${k}')">
                ${bought ? '–ö—É–ø–ª–µ–Ω–æ' : '–ö—É–ø–∏—Ç—å'}
            </button>
        </div>`;
    }
}

window.buyI = (k) => {
    let cost = getPrice(incomeList[k].base, state.incomes[k]);
    if(state.coins >= cost) {
        state.coins -= cost;
        state.incomes[k] = (state.incomes[k] || 0) + 1;
        save();
    }
};

window.buyU = (k) => {
    let p = crystalList[k].price;
    if(state.crystals >= p && !state.upgrades[k]) {
        state.crystals -= p;
        state.upgrades[k] = 1;
        save();
    }
};

function save() {
    localStorage.setItem("coins", state.coins);
    localStorage.setItem("crystals", state.crystals);
    localStorage.setItem("incomes", JSON.stringify(state.incomes));
    localStorage.setItem("upgrades", JSON.stringify(state.upgrades));
    render();
}

setInterval(() => {
    let sum = 0;
    for (let k in state.incomes) sum += (incomeList[k].inc * state.incomes[k]);
    if (state.upgrades.ultraBoost) sum *= 2;
    state.coins += sum;
    document.getElementById("coins").textContent = Math.floor(state.coins).toLocaleString();
}, 1000);

render();
</script>
</body>
</html>
